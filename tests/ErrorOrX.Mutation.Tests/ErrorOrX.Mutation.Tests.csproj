<Project Sdk="Microsoft.NET.Sdk">

    <!--
        Mutation Testing Project for ErrorOrX
        ======================================
        This project runs Stryker.NET mutation tests against the ErrorOrX runtime library.

        Why xUnit v2 instead of v3?
        - Stryker.NET 4.x doesn't support Microsoft Testing Platform (MTP) yet
        - xUnit v3 uses MTP exclusively; xUnit v2 uses VSTest
        - Tracking: https://github.com/stryker-mutator/stryker-net/issues/3094

        Usage:
            cd tests/ErrorOrX.Mutation.Tests
            dotnet stryker

        Note: Tests are linked from ErrorOrX.Tests to avoid duplication.
        Some xUnit v3 specific tests (TheoryData, IXunitSerializable) are excluded.
    -->

    <PropertyGroup>
        <TargetFramework>net10.0</TargetFramework>
        <LangVersion>14</LangVersion>
        <Nullable>enable</Nullable>
        <ImplicitUsings>enable</ImplicitUsings>
        <RootNamespace>ErrorOrX.Tests</RootNamespace>
        <IsPackable>false</IsPackable>
        <IsTestProject>true</IsTestProject>
        <!-- VSTest requires library output (no OutputType=Exe) for Stryker compatibility -->
    </PropertyGroup>

    <!-- Global usings for test convenience -->
    <ItemGroup>
        <Using Include="AwesomeAssertions"/>
        <Using Include="ErrorOr"/>
    </ItemGroup>

    <!-- Test framework: xUnit v2 + VSTest (Stryker compatible) -->
    <ItemGroup>
        <PackageReference Include="Microsoft.NET.Test.Sdk"/>
        <PackageReference Include="xunit"/>
        <PackageReference Include="xunit.runner.visualstudio">
            <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
            <PrivateAssets>all</PrivateAssets>
        </PackageReference>
        <PackageReference Include="AwesomeAssertions"/>
    </ItemGroup>

    <!-- Project under test -->
    <ItemGroup>
        <ProjectReference Include="../../src/ErrorOrX/ErrorOrX.csproj"/>
    </ItemGroup>

    <!-- xUnit runner configuration -->
    <ItemGroup>
        <Content Include="xunit.runner.json" CopyToOutputDirectory="PreserveNewest"/>
    </ItemGroup>

    <!--
        Linked test files from ErrorOrX.Tests
        =====================================
        We link rather than copy to:
        - Keep tests in sync automatically
        - Avoid maintenance burden of duplicate files

        Excluded files (xUnit v3 incompatible):
        - *EqualityTests.cs: Uses TheoryData<T,U> tuple syntax and IXunitSerializable
    -->
    <ItemGroup>
        <Compile Include="../ErrorOrX.Tests/ErrorOr/**/*.cs"
                 Link="ErrorOr/%(RecursiveDir)%(FileName)%(Extension)"
                 Exclude="../ErrorOrX.Tests/ErrorOr/*EqualityTests.cs"/>
        <Compile Include="../ErrorOrX.Tests/Errors/**/*.cs"
                 Link="Errors/%(RecursiveDir)%(FileName)%(Extension)"
                 Exclude="../ErrorOrX.Tests/Errors/*EqualityTests.cs"/>
        <Compile Include="../ErrorOrX.Tests/Results/**/*.cs"
                 Link="Results/%(RecursiveDir)%(FileName)%(Extension)"/>
    </ItemGroup>

</Project>
